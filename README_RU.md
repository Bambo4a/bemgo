<p align="right">
  <a href="https://github.com/werty1001/bemgo">English →</a>
</p>

# ![BemGo](https://werty1001.github.io/bemgo.svg)

[![GitHub license](https://img.shields.io/badge/license-MIT-blue.svg?style=flat-square)](https://raw.githubusercontent.com/werty1001/bemgo/master/LICENSE) ![](https://img.shields.io/github/languages/count/werty1001/bemgo.svg?style=flat-square) ![](https://img.shields.io/github/repo-size/werty1001/bemgo.svg?style=flat-square)

Сборка упрощает и ускоряет процесс разработки проектов по методологии [БЭМ](https://en.bem.info/), под капотом [Gulp](http://gulpjs.com/).

### Особенности
* Сборка заточена под методологию БЭМ (Блок, Элемент, Модификатор)
* Разделение структуры на независимые блоки
* Можно использовать [уровни переопределения](https://ru.bem.info/methodology/redefinition-levels/)
* Шаблонизатор [Pug](https://pugjs.org) или [Twig](http://twig.sensiolabs.org/), а также обычный HTML для разметки
* Препроцессор [LESS](http://lesscss.org/) или [Sass](http://sass-lang.com/) или [Stylus](http://stylus-lang.com/) + все прелести [PostCSS](http://postcss.org/) для стилей
* Транспайлер Babel 7 для JavaScript
* Сборка растовых и векторных спрайтов (sprite.svg / sprite.png / sprite<span></span>@2x.png / symbol.svg)
* Можно использовать JSON файлы данных для каждого блока
* Генерация иконок (Favicons) для разных платформ 
* Быстрое создание zip архива сборки или слепка разработки
* Ничего лишнего, в итоговую сборку попадут только те файлы, которые  используются
* Автоматическое создание файлов и блоков по вашему HTML коду
* Возможность сборки стилей и скриптов (бандлов) для каждой страницы отдельно

и многое другое :)

### Навигация
* [Установка](#установка)
* [Основные команды](#основные-команды)
* [Структура сборки](#структура-сборки)
* [Описание работы](#описание-работы)
* [Вопросы и ответы](#вопросы-и-ответы)
* [Changelog](#changelog)

<p align="center">
  <a href="#навигация"><img align="center" src="https://werty1001.github.io/sep.svg" alt=""></a>
</p>

# Установка

[Скачайте архив](https://github.com/werty1001/bemgo/archive/master.zip) или лучше клонируйте репозиторий:
```bash
git clone https://github.com/werty1001/bemgo.git bemgo && cd bemgo
```
Далее нужно установить зависимости из package.json с помощью npm или yarn:
```bash
npm i или yarn install
```
После можно запустить режим разработки (из коробки доступно простое демо приложение):
```bash
npm start
```

<p align="center">
  <a href="#навигация"><img align="center" src="https://werty1001.github.io/sep.svg" alt=""></a>
</p>

# Основные команды
* `npm i` — установить зависимости
* `npm start` — старт разработки
* `npm start [task]` — запуск gulp таска
* `npm run do` — запуск финальной сборки
* `npm run zip` — создание zip архива со сборкой
* `npm run zip:dev` — создание zip архива со слепком разработки
* `npm run add [command]` — быстрое [создание блоков и файлов](#создание-файлов-и-блоков-из-консоли)
* `npm run init` — старт нового проекта **

> \** **Будьте внимательны!**  
Папка app (со всеми файлами разработки) будет удалена, на ее место будет клонирован новый проект c github (репозиторий можно поменять в package.json, по умолчанию будет клонирован [этот](https://github.com/werty1001/app)).

<p align="center">
  <a href="#навигация"><img align="center" src="https://werty1001.github.io/sep.svg" alt=""></a>
</p>

# Структура сборки

```
bemgo/
│
├── app/                 # Файлы разработки
├── dist/                # Итоговая сборка
├── core/                # Ядро
├── tasks/               # Таски
│
├── gulpfile.js
└── package.json
```

Папка разработки:
```
app/
│
├── pages/               # Страницы
│   ├── index.html
│   └── about.html
│
├── blocks/              # Блоки
│   │
│   ├── common/          # Уровень common
│   │   ├── block/
│   │   └── block2/ 
│   │
│   └── develop/         # Уровень develop
│       ├── block/
│       ├── block2/
│       └── block3/
│
├── config.js            # Настройки
│
└── icon.png             # Иконка для создания favicons
```

У блока [flat](https://ru.bem.info/methodology/filestructure/#flat) (плоская) структура, все файлы и папки опциональны:
```
block/
│
├── fonts/               # Шрифты в отдельной папке
│   └── Roboto.woff2
│
├── img/                 # Изображения для стилей
│   │
│   ├── sprite/          # Иконки для создания спрайта (png и svg)
│   │   ├── mail.png
│   │   └── mail@2x.png
│   │
│   └── bg.png
│
├── symbols/             # Иконки для symbol в отдельной папке (только svg)
│   └── icon.svg
│
├── assets/              # Любые файлы
│   └── image.jpg
│
├── block.js
├── block.html
├── block.css
├── block__el.css
├── block__el.js
│
├── deps.js              # Зависимости блока
│
└── data.json            # Можно хранить данные
```

<p align="center">
  <a href="#навигация"><img align="center" src="https://werty1001.github.io/sep.svg" alt=""></a>
</p>

# Описание работы

* [Настройки приложения](#настройки-приложения)
* [Шаблонизаторы и разметка](#шаблонизаторы-и-разметка)
* [Препроцессоры и стили](#препроцессоры-и-стили)
* [Растовые и векторные спрайты](#растовые-и-векторные-спрайты)
* [SVG symbols](#svg-symbols)
* [Зависимости блока](#зависимости-блока)
* [Автоматическое создание файлов и блоков](#автоматическое-создание-файлов-и-блоков)
* [Генерация Favicons](#генерация-favicons)
* [Уровни переопределения](#уровни-переопределения)
* [Создание файлов и блоков из консоли](#создание-файлов-и-блоков-из-консоли)
* [Стартовый контент для новых файлов](#стартовый-контент-для-новых-файлов)
* [Создание нового таска](#создание-нового-таска)

<p align="center">
  <a href="#навигация"><img align="center" src="https://werty1001.github.io/sep.svg" alt=""></a>
</p>

# Настройки приложения
Все основные настройки хранятся в одном файле **app/config.js**, такой подход позволяет использовать одну сборку для разных проектов и настраивать каждое приложение индивидуально.
> Если config.js нет, то будут использованы настройки по умолчанию.

### Содержимое config.js
```js
module.exports = {

  // Описание приложения
  app: {
    name: 'Site',
  },
  
  // Используемые технологии
  extnames: {
    templates: '.pug', // по умолчанию '.html'
    scripts: '.js',    // по умолчанию '.js'
    styles: '.styl',   // по умолчанию '.css'
  },

  // Основные настройки сборки
  build: {

    babel: true, // можно включить Babel для JS
    
    bundles: [ 'css', 'js' ], // нужно ли собирать отдельные CSS/JS бандлы для страниц
    
    sourcemaps: [ 'css', 'js' ], // нужны ли sourcemap'ы
    
    autoprefixer: [ 'last 5 versions', 'ie 10', 'ie 11' ], // настройки браузеров для autoprefixer
    
    findAssets: [ 'href', 'src', 'srcset' ], // атрибуты для поиска файлов
    
    mainBundle: 'app', // название основного бандла проекта
    
    mainLevel: 'develop', // название основного уровня
    
    pugMap: 'app/blocks/map.pug', // путь (от корня) для создания PUG карты
    
    globalStyle: 'app/blocks/global.scss', // путь (от корня) до глобального файла стилей
    
    addVersions: true, // нужно ли добавлять версию (?v=23413) при подключении стилей и скриптов

    HTMLRoot: './', // корень для путей у статики в HTML
 
  },

  autoCreate: {
    // тут настройки для автоматического создания файлов
  },

  addContent: {
    // тут настройки стартого контента для файлов
  },

  // Структура финальной сборки
  dist: {
    styles: 'styles',
    fonts: 'styles/fonts',
    img: 'styles/img',
    symbol: 'styles/img',
    scripts: 'scripts',
    static: 'static',
    favicons: 'favicons',
  },

  // Порядок подключения файлов с разных уровней
  levels: {
    common: 1, // сначала отсюда
    develop: 2, // потом отсюда
  },

  generateFavicons: {
    // тут настройки для генерации Favicons
  },

  manifest: {
    // тут данные для манифеста
  },

  fastMake: {
    // тут заготовки для создания блоков из консоли
  },

}
```

<p align="center">
  <a href="#навигация"><img align="center" src="https://werty1001.github.io/sep.svg" alt=""></a>
</p>

# Шаблонизаторы и разметка

В качестве шаблонизатора разметки можно использовать Pug / Twig или обычный HTML с include'ом.  
По умолчанию выбран HTML, но вы можете это изменить в [config.js](#настройки-приложения)
```js
// app/config.js

extnames: {
  templates: '.pug', // Pug я выбираю тебя!
  ...
},

```
Теперь сборка будет искать pug файлы.  
### Данные для шаблонов
У каждого блока может быть файл данных **data.json**, эти данные доступны в разметке.  
Допустим у вас есть блок **nav** c json файлом, эти данные легко получить из специального объекта **global**:
```
global.jsons.nav // тут данные из nav/data.json
```
### Плейсхолдеры для путей
У каждого блока своя папка со статикой, поэтому вам необходимо указывать плейсхолдеры, чтобы было понятно у какого блока нужно искать конкретный файл.
> Плейсхолдер состоит из символа @ (собачки) и имени блока.

Например, у нас есть блок c картинкой **card/assets/man.png**, в разметке нужно указать путь так:
```html
<img src="@card/man.png" alt="">
```
Также есть специальные плейсхолдеры:
```html
@styles - папка стилей
@symbol - путь до SVG symbol'a
@scripts - папка скриптов
@favicons - папка фавиконок
```

### Автоматическое подключение скриптов и стилей
[Система зависимостей](#зависимости-блока) избавляет вас от нужды подключать JS и CSS файлы к странице руками, теперь достаточно указать специальный комментарий и все будет сделано автоматом.
```html
<html>
  <head>
    <!-- BEMGO:styles --> // тут будут подключены CSS файлы
  </head>
  <body>
    ...
    <!-- BEMGO:scripts --> // а тут JS файлы
  </body>
</html>
```

### Шаблонизатор PUG
При работе с PUG удобно выносить какие-то блоки в миксины и вызывать их, но есть одна проблема — в шаблонизаторе нет динамического подключения, а каждый раз подключать миксин руками больно :)  
#### Список всех PUG файлов
В сборке предусмотрено автоматическое подключение всех PUG файлов в одном. Это полностью решает проблему, а вам достаточно указать путь куда писать карту файлов в [config.js](#настройки-приложения) и затем подключить ее себе в layout.
```js
// app/config.js

build: {
  ...

  pugMap: 'app/blocks/map.pug', **
},
```
> \** Эта карта будет обновляться автоматически при каждом вызове задачи, менять что-то руками не нужно!

### Расширенные возможности HTML
Можно отказаться от шаблонизаторов и писать разметку на обычном HTML, плюс в сборке встроен дополнительный плагин, который позволяет загружать куски HTML кода, использовать переменные и циклы, а также условные конструкции, подробнее о работе этого плагина можно [узнать тут](https://www.npmjs.com/package/gulp-file-include).

<p align="center">
  <a href="#навигация"><img align="center" src="https://werty1001.github.io/sep.svg" alt=""></a>
</p>

# Препроцессоры и стили
В качестве препроцессора для стилей можно использовать LESS / Sass / Stylus или обойтись обычным CSS.  
По умолчанию выбран CSS, но вы можете это изменить в [config.js](#настройки-приложения)
```js
// app/config.js

extnames: {
  ...
  styles: '.styl', // Stylus я выбираю тебя!
},
```
Скорее всего у вас есть какой-то общий файл с переменными или миксинами, но в условиях независимости блоков его придется импортировать в каждый стиль отдельно. Мягко говоря не самый удобный вариант, поэтому есть способ лучше – вы можете указать определенный файл в настройках и он будет импортирован при сборке автоматически.
```js
// app/config.js

build: {
  ...

  globalStyle: 'app/blocks/global.scss' // Путь до файла с переменными
},
```

<p align="center">
  <a href="#навигация"><img align="center" src="https://werty1001.github.io/sep.svg" alt=""></a>
</p>

# Растовые и векторные спрайты
Вы легко можете собирать векторные спрайты, а также растовые спрайты разной плотности (2x), для этого используется замечательный [PostCSS плагин](https://github.com/2createStudio/postcss-sprites).
> Важно, в режиме разработки спрайты не создаются, только при финальной сборке! 

Все иконки для спрайта необходимо хранить в отдельной директории блока (img/sprite), если в стиле блока есть иконка из данной директории, то она попадет в спрайт.
```css
/* zoom/zoom.css */

.zoom {
  width: 24px;
  height: 24px;
  background: url('img/sprite/zoom.png') no-repeat top center;
}

.zoom_active {
  background: url('img/sprite/zoom_active.png') no-repeat top center;
}
```
В итоге в финальной сборке будет так:

```css

.zoom {
  width: 24px;
  height: 24px;
  background-image: url('img/sprite.png');
  background-position: 0 0;
}

.zoom_active {
  background-image: url('img/sprite.png');
  background-position: -24px 0;
}
```
Раньше приходилось создавать карту с переменными для каждого препроцессора отдельно, а теперь приятный и понятный CSS код, а все лишнее под капотом.

### Для ретины
Можно создавать спрайты разной плотности, например 2x, для этого достаточно сделать иконку в двойном размере и добавить ключ @2x перед расширением:
```css
/* zoom/zoom.css */

.zoom {
  width: 24px;
  height: 24px;
  background: url('img/sprite/zoom.png') no-repeat top center;
}

@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  .zoom {
    background: url('img/sprite/zoom@2x.png') no-repeat top center;
    background-size: 24px 24px;
  }
}
```
### Вектор
Одновременно с растовыми спрайтами можно создавать и векторные, принцип тот же, только SVG:
```css

.zoom {
  width: 24px;
  height: 24px;
  background: url('img/sprite/zoom.svg') no-repeat top center;
}
```

<p align="center">
  <a href="#навигация"><img align="center" src="https://werty1001.github.io/sep.svg" alt=""></a>
</p>

# SVG symbols
Помимо обычных спрайтов для стилей, можно использовать SVG символы в HTML, иконки для этого спрайта нужно хранить в отдельной папке блока (symbols). Для каждой иконки будет сгенерирован свой ID по шаблону block-name__icon-name, например:
```
card/symbols/arrow.svg -> #card__arrow
```
### Подключение SVG спрайта
Есть несколько вариантов подключения SVG, можно встроить прямо в HTML код, для этого вам нужно указать специальный комментарий:
```html
<!-- BEMGO:symbol -->
```
Тогда в теге use достаточно только ID:
```html
<svg>
  <use xlink:href="#card__arrow"></use>
</svg>
```
Второй вариант внешний файл, тогда в теге use необходимо указывать специальный плейсхолдер:
```html
<svg>
  <use xlink:href="@symbol#card__arrow"></use>
</svg>
```
### Трансформация SVG спрайта
Если в коде страницы будет найдена хотя-бы одна SVG иконка, то сборка будет искать специальный блок symbol на основном уровне разработки (св-во **mainLevel** в [config.js](#настройки-приложения)), вы можете создать два файла `prepend.svg` и `append.svg` внутри этого блока и тогда содержимое этих файлов будет добавлено в тело SVG (в начало и в конец).
### Сборка SVG спрайта
В режиме разработки все иконки со всех блоков будут добавлены в спрайт, но в финальную сборку попадут только те иконки, которые есть в вашем коде. Также вы можете добавить специальный ключ @always перед расширением иконки, тогда она попадет в спрайт в любом случае:
```
card/symbols/arrow@always.svg
```

<p align="center">
  <a href="#навигация"><img align="center" src="https://werty1001.github.io/sep.svg" alt=""></a>
</p>

# Зависимости блока
Для любого блока можно указать зависимости (другие блоки или модули) в файле deps.js
```js
// deps.js

module.exports = {

  nodes: [], // Сущности, блоки / элементы / модификаторы

  modules: [], // Модули

}
```
Например, есть блок select и с помощью JS ему динамически добавляется модификатор select_open, в HTML коде этого модификатора нет, поэтому он не будет включен в сборку, чтобы это исправить достаточно добавить этот модификатор в файле deps.js
```js
// select/deps.js

module.exports = {

  nodes: [
    'select_open'
  ],

}
```
Теперь все в порядке, сборка знает, что этот модификатор используется. По аналогии можно добавлять другие сущности, элементы и блоки.
### Модули
Второй вариант зависимостей это модули, каждый модуль это объект с 3-мя свойствами:
```js
// deps.js

module.exports = {

  modules: [
    {
      from: '',   // расположение модуля
      inject: [], // список файлов, которые будут подключены как отдельные файлы
      import: [], // список файлов, которые будут импортированы в общий бандл
    },
  ],

}
```
Например у нас есть блок slider, для полноценной работы ему нужен плагин [slick](http://kenwheeler.github.io/slick/), который в свою очередь использует библиотеку jQuery:
```js
// slider/deps.js

module.exports = {

  modules: [
    {
      from: 'https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/', // подключим jQuery с CDN
      inject: [ 'jquery.min.js' ], // Этот файл будет подключен на странице отдельно
    },
    {
      from: 'node_modules/slick-carousel/slick', // подключим slick из node_modules
      inject: [ 'slick.min.js' ], // Этот файл будет подключен на странице отдельно
      import: [ 'slick.css' ], // этот файл попадет в общий CSS бандл
    },
  ],

}
```
Теперь при использовании блока slider на странице будет подключена библиотека jQuery и плагин slick.min.js, все картинки и шрифты из slick.css автоматом подтянутся в сборку.

> Если у модуля не указано св-во from, то поиск будет проходить в самом блоке в папке assets!  
Файлы из CDN нельзя импортировать, только подключать как внешний файл!

Если вам требуется подключить модуль асинхронно, то просто добавьте на конце @async или @defer:
```js
{
  from: 'node_modules/slick-carousel/slick',
  inject: [ 'slick.min.js@async' ], // Этот файл будет подключен на странице c атрибутом async
},
```

<p align="center">
  <a href="#навигация"><img align="center" src="https://werty1001.github.io/sep.svg" alt=""></a>
</p>

# Автоматическое создание файлов и блоков
Вы просто пишите БЭМ код, а блоки и файлы создаются автоматически.  
По умолчанию данная фича выключена, чтобы ее активировать вам нужно добавить настройки в [config.js](#настройки-приложения)
```js
// app/config.js

autoCreate: {
  folders: [], // список директорий у нового блока, например: 'img', 'assets'
  files: [], // список файлов у нового блока, например: 'style', 'template', 'data', 'deps', 'script'
  levels: [], // уровни, где будут создаваться блоки, например: 'develop'
  ignoreNodes: [], // список сущностей, которые будут проигнорированы полностью **
},

```
> \** Тут можно использовать регулярные выражения!

Допустим мне нужно создавать блоки на уровне develop, у каждого нового блока должен быть файл стилей, скрипт и папка для картинок, но при этом нужно игнорировать элементы и не создавать файлы для них:
```js
// app/config.js

autoCreate: {
  folders: [ 'assets' ], // у новых блоков сразу будет создана папка assets
  files: [ 'style', 'script' ], // у новых блоков будет стиль и скрипт
  levels: [ 'develop' ], // новые блоки создаются только на уровне develop
  ignoreNodes: [ /__[\w]/i ], // все элементы будут проигнорированы
},

```
Отлично, но при таких настройках для каждого модификатора блока также будут созданы отдельные файлы стилей и скриптов, если вам это не нужно, то можно дополнить настройки:
```js
// app/config.js

autoCreate: {
  folders: [ 'img', 'assets' ],
  files: [ 'style', 'script' ],
  levels: [ 'develop' ],
  ignoreNodes: [ /__[\w]/i ],
  ignoreStyle: [ /(_|--)[\w]/i ], // игнорируем модификаторы при создании стилей
  ignoreScript: [ /(_|--)[\w]/i  ], // игнорируем модификаторы при создании скриптов
  ignoreTemplate: [], // по аналогии можно указать и для шаблонов
},

```
Регулярные выражения позволят вам тонко настроить создание файлов и блоков.

<p align="center">
  <a href="#навигация"><img align="center" src="https://werty1001.github.io/sep.svg" alt=""></a>
</p>

# Генерация Favicons

1. Для начала вам необходимо поместить свою иконку в корень папки разработки (**app/icon.png**).
2. Далее в конфинге приложения [config.js](#настройки-приложения) нужно указать какие иконки нужно создать:

> Если нет icon.png, то ничего создано не будет, а в режиме разработки эта задача игнорируется всегда! 

```js
// app/config.js

generateFavicons: {
  android: false,
  appleIcon: false,
  appleStartup: false,
  coast: false,
  favicons: true, // по умолчанию только этот пункт true
  firefox: false,
  windows: false,
  yandex: false,
},

// также можно указать данные для манифеста

manifest: {
  appName: null,
  appShortName: null,
  appDescription: null,
}
```

Для создания иконок используется [этот плагин](https://github.com/itgalaxy/favicons), можете посмотреть полные настройки по ссылке, замечу, что плагин позволяет указать данные для манифеста, цвет для фона иконок и всякое разное другое.

<p align="center">
  <a href="#навигация"><img align="center" src="https://werty1001.github.io/sep.svg" alt=""></a>
</p>

# Уровни переопределения
Вы можете использовать любое количество уровней переопределения для организации блоков, несколько или всего один, при этом поиск файлов будет происходить по всем, а порядок подключения уровней можно настроить в [config.js](#настройки-приложения)
#### Зачем это нужно?
Уровни переопределения позволяют разделять блоки и доопределять стили и скрипты, если вам нужны более тонкие настройки переопределения, то для этого лучше подойдет стек Яндекса.

<p align="center">
  <a href="#навигация"><img align="center" src="https://werty1001.github.io/sep.svg" alt=""></a>
</p>

# Создание файлов и блоков из консоли
Если по каким-то причинам не подходит [автоматическое создание файлов и блоков](#автоматическое-создание-файлов-и-блоков), то вы можете быстро создавать блоки и файлы из консоли простой командой `npm run add`.
> Если какие-то файлы и папки уже есть, то они просто будут проигнорированы.

Создадим блок **header** и **footer** с дополнительными файлами:
```bash
npm run add header[.css,.js] footer[.pug]
```
> **Результат:**  
Будет создана папка header  
Будет создан файл header/header.css  
Будет создан файл header/header.js  
Будет создана папка footer  
Будет создан файл footer/footer.pug

Можно создавать элементы и модификаторы:
```bash
npm run add header__logo[.css,.js] footer__inner[.styl] footer_home[.styl]
```
> **Результат:**  
Будет создана папка header  
Будет создан файл header/header__logo.css  
Будет создан файл header/header__logo.js  
Будет создана папка footer  
Будет создан файл footer/footer__inner.styl  
Будет создан файл footer/footer_home.styl

Также можно создавать папки внутри блока:
```bash
npm run add card[img/sprite,assets,.pug,deps.js]
```
> **Результат:**  
Будет создана папка card  
Будет создана папка card/img  
Будет создана папка card/img/sprite  
Будет создана папка card/assets  
Будет создан файл card/card.pug  
Будет создан файл card/deps.js

По умолчанию все сущности создаются на основном уровне (св-во **mainLevel** в [config.js](#настройки-приложения)), но вы можете указать уровень напрямую через двоеточие:
```bash
npm run add card[.js,.scss] :common
```
> **Результат:**  
Будет создана папка common (уровень)  
Будет создана папка common/card  
Будет создан файл common/card/card.js  
Будет создан файл common/card/card.scss  

Еще можно быстро создавать страницы, для этого нужно указать ключевое слово **page** после add:
```bash
npm run add page index catalog about.html
```
> **Результат:**  
Будет создана папка pages  
Будет создан файл pages/index.pug *  
Будет создан файл pages/catalog.pug *  
Будет создан файл pages/about.html  
\------  
\* Если не указано расширение страницы, то оно будет взято из app/config.js

Чтобы не перечислять каждый раз файлы и папки вы можете создать заготовки в [config.js](#настройки-приложения)
```js
// app/config.js

fastMake: {
  b: ['.js','.css','.pug','img']
}
```
Теперь совсем хорошо:
```bash
npm run add header[b]
```
> **Результат:**  
Будет создана папка header  
Будет создан файл header/header.js  
Будет создан файл header/header.css  
Будет создан файл header/header.pug  
Будет создана папка header/img

<p align="center">
  <a href="#навигация"><img align="center" src="https://werty1001.github.io/sep.svg" alt=""></a>
</p>

# Стартовый контент для новых файлов
При создании файлов [автоматом](#автоматическое-создание-файлов-и-блоков) или [руками](#создание-файлов-и-блоков-из-консоли) им можно добавить стартовый контент, для этого нужно добавить настройки в [config.js](#настройки-приложения)
```js
// app/config.js

addContent: {
  page: 'I make [name] page.', // [name] будет заменено на название страницы
  css: '.[name] {}', // [name] будет заменено на название css файла
}
```
Теперь при создании CSS файла `npm run add header[.css]` его содержимое будет таким:
```css
.header {}
```

<p align="center">
  <a href="#навигация"><img align="center" src="https://werty1001.github.io/sep.svg" alt=""></a>
</p>

# Создание нового таска
Чтобы создать свою задачу вам необходимо добавить новый js файл в папку тасков с минимальным функционалом:
```js
// tasks/mytask.js

'use strict'

module.exports = {
  name: 'mytask',
  run ( done ) {
    console.log( 'Поехали!' )
    return done()
  },
}
```
> Каждая задача обязательно должна содержать имя и функцию run, которая должна возвращать callback или например stream, подробнее об этом можно узнать [в доках галпа](https://gulpjs.com/docs/en/getting-started/async-completion).

#### Теперь можно запустить:
```bash
npm start mytask
```
> **Результат:**  
Поехали!

Все работает, теперь можно включить задачу в общую сборку, за это отвечает свойство **build**, которое содержит номер выполнения:
```js
// tasks/mytask.js

'use strict'

module.exports = {
  name: 'mytask',
  build: 4, // задача будет запущена под № 4 **
  run ( done ) {
    console.log( 'Поехали!' )
    return done()
  },
}
```
> \** При этом несколько задач могут иметь одинаковый номер, в таком случае они будут выполняться параллельно

Общая сборка имеет следующий порядок:
```
0. [ del ]
1. [ compile:templates ]
2. [ generate:symbol, compile:styles, compile:scripts ]
3. [ copy:assets, copy:fonts, copy:imgs, generate:favicons, inject ]

4. [ mytask ] // наша новая задача будет запущена последней
```
Также задача может содержать функцию watch, которая должна возвращать объект с настройками для слежения:
```js
watch () {
  return {
    files: '**/**/*.md', // glob для слежения за файлами
    tasks: 'mytask', // имя задачи или массив задач для запуска
  }
},
```

<p align="center">
  <a href="#навигация"><img align="center" src="https://werty1001.github.io/sep.svg" alt=""></a>
</p>

# Вопросы и ответы

#### А где хранить глобальные файлы? Есть общая папка для таких целей?
* Нету. Но это вообще не проблема! Для хранения каких-то общих файлов можно использовать корневой блок, например **page** или **app**, у вас скорее всего такой будет.

#### Как включить файл в итоговую сборку независимо от того, есть ли он коде или нет?
* Легко, просто добавьте файлу специальный ключ @always перед расширением, например man<span></span>@always.png, это сработает для любых статичных файлов.

#### А сюда можно встроить Vue или React?
* Наверно, но зачем? Данная сборка решает другие задачи, при разработке SPA лучше использовать специальные инструменты, например Create React App или Vue CLI.

### Остались вопросы?
* Вы можете [создать issue](https://github.com/werty1001/bemgo/issues/new) или написать мне напрямую в телеграмм [@werty1001](https://telegram.me/werty1001).

<p align="center">
  <a href="#навигация"><img align="center" src="https://werty1001.github.io/sep.svg" alt=""></a>
</p>

# Changelog

### 1.0.0
* Переписан почти весь код :)
* Обновлены все плагины
* Убран webpack
* Добавлена система зависимостей для блоков
* Добавлено автоматическое подключение скриптов и стилей на основе зависимостей
* Добавлено подробное описание на русском

### 0.1.0
* beta version

